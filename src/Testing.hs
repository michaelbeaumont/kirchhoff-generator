module Testing where

import Data.Maybe (fromJust)
import Types


testCompTreeSafe = RoseTree (Block False Forward 5 (Value 4) 0 0) [RoseTree (Block True Forward 4 (Value 1) 0 0) [RoseNode (Resistor Forward (Value 3) 0 0),RoseNode (Resistor Forward (Value 3) 0 0), RoseTree (Block False Forward 2 (Value 3) 0 0) [RoseNode (Resistor Forward (Value 3) 0 0), RoseNode (Source (VoltageSource 2))]], RoseNode (Resistor Forward (Value 3) 0 0)]

testCompTree = RoseTree (Block True Forward 4 (Value 1) 0 0) [RoseNode (Resistor Forward (Value 3) 0 0),RoseNode (Resistor Forward (Value 3) 0 0), RoseTree (Block False Forward 2 (Value 3) 0 0) [RoseNode (Resistor Forward (Value 3) 0 0), RoseNode (Source (VoltageSource 2))]]

bigTestTree = RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 5, _res = Value 76.0, _vol = 63.0, _cur = 0.8289473684210527}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 4, _res = Value 114.0, _vol = 63.0, _cur = 0.5526315789473684}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 3, _res = Value 91.0, _vol = 50.28947368421053, _cur = 0.5526315789473684}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 2, _res = Value 140.0, _vol = 50.28947368421053, _cur = 0.3592105263157894}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 78, rVol = 28.01842105263158, rCur = 0.3592105263157894}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 62, rVol = 22.271052631578947, rCur = 0.3592105263157894}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 260, rVol = 50.28947368421053, rCur = 0.1934210526315789}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 23, rVol = 12.710526315789473, rCur = 0.5526315789473684}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 228, rVol = 63.0, rCur = 0.2763157894736842}}]}

bigTestTreeMulSrc = RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 5, _res = Value 76.0, _vol = 63.0, _cur = 0.8289473684210527}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 4, _res = Value 114.0, _vol = 63.0, _cur = 0.5526315789473684}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 3, _res = Value 91.0, _vol = 50.28947368421053, _cur = 0.5526315789473684}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 2, _res = Value 140.0, _vol = 50.28947368421053, _cur = 0.3592105263157894}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 78, rVol = 28.01842105263158, rCur = 0.3592105263157894}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 62, rVol = 22.271052631578947, rCur = 0.3592105263157894}}]},RoseNode {component = Source (VoltageSource 2)}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 23, rVol = 12.710526315789473, rCur = 0.5526315789473684}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 228, rVol = 63.0, rCur = 0.2763157894736842}}]}

hugeTree = RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 9, _res = Value 191.0, _vol = 15.0, _cur = 7.853403141361257e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 5, _res = Value 148.0, _vol = 11.62303664921466, _cur = 7.853403141361257e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 3, _res = Value 222.0, _vol = 11.62303664921466, _cur = 5.235602094240838e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 2, _res = Value 89.0, _vol = 4.659685863874346, _cur = 5.235602094240838e-2}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 178, rVol = 4.659685863874346, rCur = 2.617801047120419e-2}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 178, rVol = 4.659685863874346, rCur = 2.617801047120419e-2}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 133, rVol = 6.963350785340314, rCur = 5.235602094240838e-2}}]},RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 2, _res = Value 444.0, _vol = 11.62303664921466, _cur = 2.617801047120419e-2}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 152, rVol = 3.979057591623037, rCur = 2.617801047120419e-2}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 292, rVol = 7.643979057591624, rCur = 2.617801047120419e-2}}]}]},RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 4, _res = Value 43.0, _vol = 3.3769633507853403, _cur = 7.853403141361257e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 3, _res = Value 86.0, _vol = 3.3769633507853403, _cur = 3.926701570680628e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 2, _res = Value 34.0, _vol = 1.3350785340314135, _cur = 3.926701570680628e-2}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 51, rVol = 1.3350785340314135, rCur = 2.617801047120419e-2}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 102, rVol = 1.3350785340314135, rCur = 1.3089005235602094e-2}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 52, rVol = 2.0418848167539267, rCur = 3.926701570680628e-2}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 86, rVol = 3.3769633507853403, rCur = 3.926701570680628e-2}}]}]}

hugeTreeSrc = RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 9, _res = Value 133.2245989304813, _vol = 15.0, _cur = 7.853403141361257e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 5, _res = Value 90.224598930481290, _vol = 11.62303664921466, _cur = 7.853403141361257e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 3, _res = Value 222.0, _vol = 11.62303664921466, _cur = 5.235602094240838e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 2, _res = Value 89.0, _vol = 4.659685863874346, _cur = 5.235602094240838e-2}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 178, rVol = 4.659685863874346, rCur = 2.617801047120419e-2}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 178, rVol = 4.659685863874346, rCur = 2.617801047120419e-2}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 133, rVol = 6.963350785340314, rCur = 5.235602094240838e-2}}]},RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 2, _res = Value 152.0, _vol = 11.62303664921466, _cur = 2.617801047120419e-2}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 152, rVol = 3.979057591623037, rCur = 2.617801047120419e-2}},RoseNode {component = Source (VoltageSource 3)}]}]},RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 4, _res = Value 43.0, _vol = 3.3769633507853403, _cur = 7.853403141361257e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = False, _dir = Forward, _size = 3, _res = Value 86.0, _vol = 3.3769633507853403, _cur = 3.926701570680628e-2}, treeChildren = [RoseTree {treeBlock = Block {parallel = True, _dir = Forward, _size = 2, _res = Value 34.0, _vol = 1.3350785340314135, _cur = 3.926701570680628e-2}, treeChildren = [RoseNode {component = Resistor {rDir = Forward, rRes = Value 51, rVol = 1.3350785340314135, rCur = 2.617801047120419e-2}},RoseNode {component = Resistor {rDir = Forward, rRes = Value 102, rVol = 1.3350785340314135, rCur = 1.3089005235602094e-2}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 52, rVol = 2.0418848167539267, rCur = 3.926701570680628e-2}}]},RoseNode {component = Resistor {rDir = Forward, rRes = Value 86, rVol = 3.3769633507853403, rCur = 3.926701570680628e-2}}]}]}

initA = (testCompTreeSafe, Source (VoltageSource 5))
bigTestNetz = (bigTestTree, Source (VoltageSource 5))
bigTestMulNetz = (bigTestTreeMulSrc, Source (VoltageSource 5))
hugeNetz = (hugeTree, Source (VoltageSource 5))
hugeSrcNetz = (hugeTreeSrc, Source (VoltageSource 5))

power0 = powerNetz initA
zipA = Just (netzToZipper initA) >>= petalDown >>= petalDown >>= petalRight >>= petalRight >>= petalDown >>= petalRight

powerA = fmap liftPowerRestore zipA

tA = fromJust . fromJust $ powerA
t0 = snd power0

